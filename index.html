<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>javascriptgantt</title>
    <link rel="stylesheet" href="./style.css" />
    <link rel="stylesheet" href="src/gantt.css" />
    <link rel="stylesheet" href="src/assets/zt-tour/zt-tour.css" />
    <!-- <link rel="stylesheet" href="./theme/dark.css" /> -->
    <link rel="shortcut icon" href="src/assets/images/jsGanttLogo.png" type="image/x-icon" />
    <script src="src/gantt.js"></script>
</head>

<body>
    <div class="js-gantt-d-flex action-container">
        <div class="collapse-container">
            <span>Collapse</span>
            <input type="checkbox" id="collapse-switch" onchange="changeCollapse(event)" />
            <label for="collapse-switch">collapse</label>
        </div>

        <div class="collapse-container today-container">
            <span>Today</span>
            <input type="checkbox" id="today-switch" checked="true" onchange="changeToday(event)" />
            <label for="today-switch">Today</label>
        </div>
        <div class="export-data">
            <select class="export" id="export" placeholder="Export" onchange="exportChange(event)">
                <option value="" disabled="" selected="">Export</option>
                <option value="png">Export To PNG</option>
                <option value="pdf">Export To PDF</option>
                <option value="excel">Export To Excel</option>
            </select>
        </div>
        <div class="fullscreen">
            <button class="btn" onclick="changeScreen()">FullScreen</button>
        </div>
        <div class="auto-scheduling">
            <!-- <span class="coming-soon">coming soon</span> -->
            <button class="btn" onclick="autoScheduling()">Auto Scheduling</button>
        </div>
        <div class="zoom">
            <select class="scale-zoom" id="scale_zoom" placeholder="Zoom to" onchange="changeZoom(event)">
                <option value="" disabled="">Zoom to:</option>
                <option value="year">Years</option>
                <option value="quarter">Quarters</option>
                <option value="month">Months</option>
                <option value="week">Weeks</option>
                <option value="day" selected="day">Days</option>
                <option value="hour">Hour</option>
            </select>
        </div>
        <div class="Language">
            <select class="lang" id="lang" placeholder="Select Language" onchange="changeLang(event)">
                <option value="" disabled="" selected="">Select Language:</option>
                <option value="ar">Arabic</option>
                <option value="be">Belarusian</option>
                <option value="en" selected="en">English</option>
                <option value="ca">Catalan</option>
                <option value="cn">Chinese</option>
                <option value="hr">Croatian</option>
                <option value="cs">Czech</option>
                <option value="da">Danish</option>
                <option value="nl">Dutch</option>
                <option value="fi">Finnish</option>
                <option value="fr">French</option>
                <option value="de">German</option>
                <option value="el">Greek</option>
                <option value="he">Hebrew</option>
                <option value="hi">Hindi (India)</option>
                <option value="hu">Hungarian</option>
                <option value="id">Indonesian</option>
                <option value="it">Italian</option>
                <option value="ja">Japanese</option>
                <option value="kr">Korean</option>
                <option value="no">Norwegian</option>
                <option value="fa">Persian</option>
                <option value="pl">Polish</option>
                <option value="pt">Portuguese</option>
                <option value="ro">Romanian</option>
                <option value="ro">Russian</option>
                <option value="sk">Slovak</option>
                <option value="si">Slovenian</option>
                <option value="es">Spanish</option>
                <option value="sv">Swedish</option>
                <option value="tr">Turkish</option>
                <option value="ua">Ukrainian</option>
            </select>
        </div>

        <div class="dark-mode">
            <span>Dark Mode</span>
            <input type="checkbox" id="toggle" onchange="changeTheme(event.target.checked)" class="toggle--checkbox" />
            <label for="toggle" class="toggle-theme"> </label>
        </div>
        <div class="fullscreen">
            <button class="btn" style="margin-left: 10px" onclick="startTour()">
                Start Tour
            </button>
            <svg class="hint-icon" width="18px" height="18px" style="margin-bottom: -4px;" viewBox="0 0 1024 1024"
                xmlns="http://www.w3.org/2000/svg" fill="#000000">
                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                <g id="SVGRepo_iconCarrier">
                    <path fill="#55A5FF"
                        d="M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm23.744 191.488c-52.096 0-92.928 14.784-123.2 44.352-30.976 29.568-45.76 70.4-45.76 122.496h80.256c0-29.568 5.632-52.8 17.6-68.992 13.376-19.712 35.2-28.864 66.176-28.864 23.936 0 42.944 6.336 56.32 19.712 12.672 13.376 19.712 31.68 19.712 54.912 0 17.6-6.336 34.496-19.008 49.984l-8.448 9.856c-45.76 40.832-73.216 70.4-82.368 89.408-9.856 19.008-14.08 42.24-14.08 68.992v9.856h80.96v-9.856c0-16.896 3.52-31.68 10.56-45.76 6.336-12.672 15.488-24.64 28.16-35.2 33.792-29.568 54.208-48.576 60.544-55.616 16.896-22.528 26.048-51.392 26.048-86.592 0-42.944-14.08-76.736-42.24-101.376-28.16-25.344-65.472-37.312-111.232-37.312zm-12.672 406.208a54.272 54.272 0 0 0-38.72 14.784 49.408 49.408 0 0 0-15.488 38.016c0 15.488 4.928 28.16 15.488 38.016A54.848 54.848 0 0 0 523.072 768c15.488 0 28.16-4.928 38.72-14.784a51.52 51.52 0 0 0 16.192-38.72 51.968 51.968 0 0 0-15.488-38.016 55.936 55.936 0 0 0-39.424-14.784z">
                    </path>
                </g>
            </svg>
        </div>
        <!-- <button onclick="javascriptgantt.destroy()">destroy</button>
      <button onclick="javascriptgantt.render()">render</button> -->
        <!-- <button onclick="addCol()">Add Column</button>
      <button onclick="removeCol()">Remove Column</button> -->
        <input type="search" placeholder="Search Task" id="gantt-search" name="gantt-search" class="gantt-search"
            oninput="searchTask(event)" />
    </div>
    <div id="js-gantt"></div>
    </div>
    <script src="src/assets/zt-tour/zt-tour.js"></script>
    <script>
        let data = generateGanttData();

        // let parents = [1]//,8,9,10,11]
        // for(let i = 0; i < parents.length; i++){
        //   for(let j = 0; j < 50; j++){
        //     let task =  {
        //     id: `task-${parents[i]}-${j}`,
        //     text: "Test #Task",
        //     start_date: "03-09-2024",
        //     end_date: "03-09-2024",
        //     parent: parents[i],
        //     progress: 50,
        //   }
        //   data.push(task);
        //   }
        // }

function generateGanttData() {
    const currentDate = new Date();
    const currentYear = currentDate.getFullYear();
    const currentMonth = currentDate.getMonth() + 1; // JavaScript months are 0-based
    
    function getRandomDay() {
        return Math.floor(Math.random() * 28) + 1; // Ensure the day is within a valid range
    }
    
    function formatDate(day) {
        return `${currentMonth.toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}-${currentYear}`;
    }
    
    let data = [];
    let idCounter = 1;
    
    for (let project = 1; project <= 5; project++) {
        const projectId = idCounter++;
        data.push({ id: projectId, text: `Project ${project}`, parent: 0, progress: Math.floor(Math.random() * 100) });

        const numTasks = Math.floor(Math.random() * 4) + 2; // 2 to 5 tasks per project
        for (let task = 1; task <= numTasks; task++) {
            const startDay = getRandomDay();
            const endDay = Math.min(startDay + Math.floor(Math.random() * 5) + 1, 28);
            
            data.push({
                id: idCounter++,
                text: `Task #${idCounter}`,
                start_date: formatDate(startDay),
                end_date: formatDate(endDay),
                parent: projectId,
                progress: Math.floor(Math.random() * 100),
            });
        }
    }
    
    return data;
}


        let element = document.getElementById("js-gantt");
        let javascriptGantt = new javascriptgantt(element);
        window.javascriptgantt = javascriptGantt;

        const textEditor = { type: "text", map_to: "text" };
        const dateEditor = {
            type: "date", map_to: "start_date", min: new Date(2018, 0, 1),
            max: new Date(2019, 0, 1)
        };
        const numberEditor = { type: "number", map_to: "progress", min: 0, max: 100 };
        const selectEditor = { type: "select", map_to: "priority", options: ["Low", "Medium", "High"] };

        javascriptGantt.options.columns = [
            {
                name: "text",
                width: 245,
                min_width: 80,
                max_width: 300,
                tree: true,
                label: "Task Name",
                resize: true,
                template: (task) => {
                    return `<span>${task.text}</span>`;
                },
                editor: textEditor
            },
            {
                name: "progress",
                width: 245,
                min_width: 80,
                max_width: 300,
                tree: false,
                label: "Progress",
                resize: true,
                align: "center",
                template: (task) => {
                    return `<span>${task.progress || 0}</span>`;
                },
                // editor: numberEditor
            },
            // {
            //   name: "start_date",
            //   width: 245,
            //   min_width: 80,
            //   max_width: 300,
            //   tree: false,
            //   label: "Start Date",
            //   resize: true,
            //   align: "center",
            //   template: (task) => {
            //     return `<span>${task.start_date || 0}</span>`;
            //   },
            //   editor: dateEditor
            // },
            // {
            //   name: "priority",
            //   width: 245,
            //   min_width: 80,
            //   max_width: 300,
            //   tree: false,
            //   label: "Priority",
            //   resize: true,
            //   align: "center",
            //   template: (task) => {
            //     return `<span>${task?.priority || ""}</span>`;
            //   },
            //   editor: selectEditor
            // },
        ];

        javascriptGantt.options.date_format = "%m-%d-%Y";
        javascriptGantt.options.localLang = "en";
        javascriptGantt.options.data = data;
        javascriptGantt.options.collapse = false;
        javascriptGantt.options.weekends = ["Sat", "Sun"];
        javascriptGantt.options.fullWeek = true;
        javascriptGantt.options.todayMarker = true;
        javascriptGantt.options.dropArea = true;
        javascriptGantt.options.customMarker = [
            {
                start_date: '06-20-2024',
                css: "party",
                text: "ðŸŽ‚ ðŸŽ‰",
                title: "Ek aur Sal Barbad!"
            }
        ];
        javascriptGantt.options.updateLinkOnDrag = true;
        javascriptGantt.options.splitTask = false;
        javascriptGantt.options.sort = true;
        // javascriptgantt.templates.showLightBox = false;

        // new feature of gantt -----
        javascriptGantt.options.mouseScroll = true; // default is false
        javascriptGantt.options.ctrlKeyRequiredForMouseScroll = true; // default is true

        javascriptGantt.options.addLinks = (task) => {
            if (task.parent === 0) {
                return false;
            }
            return true;
        };

        javascriptGantt.options.exportApi = "";
        // javascriptgantt.options.exportApi = "http://192.168.0.155:8300/";
        javascriptGantt.options.taskColor = true;
        javascriptGantt.options.taskOpacity = 0.7;
        javascriptGantt.options.links = [
            // 0 is  finish_to_start  
            // 1 is  start_to_start  
            // 2 is  finish_to_finish  
            // 3 is  start_to_finish 
            { id: 1, source: 2, target: 23, type: 1 },
            { id: 2, source: 3, target: 6, type: 2 },
            { id: 3, source: 4, target: 23, type: 3 },
            { id: 4, source: 12, target: 15 },
        ];
        javascriptGantt.options.weekStart = 1; // set the start of the week
        javascriptGantt.options.sidebarWidth = 300;
        javascriptGantt.options.scales = [
            {
                unit: "week",
                step: 1,
                format: (t) => {
                    const { startDate: a, endDate: n, weekNum: i } = weekStartAndEnd(t);
                    return ` ${javascriptGantt.formatDateToString(
                        "%j %M",
                        a
                    )} - ${javascriptGantt.formatDateToString(
                        "%j %M",
                        n
                    )}, ${a.getFullYear()}`;
                },
            },
            { unit: "day", step: 1, format: "%d %D" },
        ];

        javascriptGantt.options.zoomLevel = "day";

        // zoom config
        javascriptGantt.options.zoomConfig = {
            levels: [
                {
                    name: "hour",
                    scale_height: 27,
                    min_col_width: 550,
                    scales: [
                        { unit: "day", step: 1, format: "%d %M" },
                        { unit: "hour", step: 1, format: "%H" },
                    ],
                },
                {
                    name: "day",
                    scale_height: 27,
                    min_col_width: 80,
                    scales: [
                        { unit: "week", step: 1, format: "%W" },
                        { unit: "day", step: 1, format: "%d %M" },
                    ],
                },
                {
                    name: "week",
                    scale_height: 45,
                    min_col_width: 50,
                    scales: [
                        { unit: "month", step: 1, format: "%M" },
                        {
                            unit: "week",
                            step: 1,
                            format: (t) => {
                                const {
                                    startDate: a,
                                    endDate: n,
                                    weekNum: i,
                                } = weekStartAndEnd(t);
                                return ` ${javascriptGantt.formatDateToString(
                                    "%j %M",
                                    a
                                )} - ${javascriptGantt.formatDateToString(
                                    "%j %M",
                                    n
                                )}, ${a.getFullYear()}`;
                            },
                        },
                    ],
                },
                {
                    name: "month",
                    scale_height: 30,
                    min_col_width: 120,
                    scales: [
                        { unit: "year", step: 1, format: "%Y" },
                        { unit: "month", step: 1, format: "%M" },
                    ],
                },
                {
                    name: "quarter",
                    scale_height: 25,
                    min_col_width: 90,
                    scales: [
                        { unit: "year", step: 1, format: "%Y" },
                        { unit: "quarter", step: 1, format: "Q%q" },
                        { unit: "month", format: "%M" },
                    ],
                },
                {
                    name: "year",
                    scale_height: 30,
                    min_col_width: 30,
                    scales: [
                        { unit: "year", step: 3, format: "2022 - 2024" },
                        { unit: "year", step: 1, format: "%Y" },
                    ],
                },
            ],
        };

        javascriptGantt.options.scale_height = 30;
        javascriptGantt.options.row_height = 24;
        javascriptGantt.options.minColWidth = 80;
        javascriptGantt.options.selectAreaOnDrag = true;
        javascriptGantt.options.taskProgress = true;

        // Gantt layout to implement columns in right side
        // javascriptgantt.options.rightGrid = [
        // {
        //     name: "text",
        //     width: 245,
        //     min_width: 80,
        //     max_width: 120,
        //     tree: true,
        //     label: "Task Name",
        //     resize: true,
        //     template: (task) => {
        //       return `<span>${task.text}</span>`;
        //     },
        //   },
        //   {
        //     name: "text",
        //     width: 245,
        //     min_width: 80,
        //     max_width: 120,
        //     tree: false,
        //     align: "center",
        //     label: "Task Name",
        //     resize: true,
        //     template: (task) => {
        //       return `<span>${task.text}</span>`;
        //     },
        //   },
        // ];

        function weekStartAndEnd(t) {
            const e = t.getDay();
            let a, n;
            0 === e
                ? ((a = javascriptGantt.add(t, -6, "day")), (n = t))
                : ((a = javascriptGantt.add(t, -1 * e + 1, "day")),
                    (n = javascriptGantt.add(t, 7 - e, "day")));
            return {
                startDate: a,
                endDate: n,
                weekNum: javascriptGantt.formatDateToString("%W", t),
            };
        }
        const currentDate = new Date();

        javascriptGantt.options.startDate = currentDate.setDate(1);
        javascriptGantt.options.endDate = currentDate.setDate(31);

        javascriptGantt.templates.tooltip_text = function (start, end, task) {
            return `<b>${task.parent === 0 ? "Project" : "Task"}:</b>
            ${task.text}
            <br/><b>Start date:</b>
            ${javascriptGantt.formatDateToString("%d-%m-%y %H:%i", start)}
            <br/><b>End date:</b>
            ${javascriptGantt.formatDateToString("%d-%m-%y %H:%i", end)}<br/>
            <b>Duration:</b> ${task.duration} ${task.duration > 1 ? "Days" : "Day"
                }`;
        };

        javascriptGantt.templates.taskbar_text = function (start, end, task) {
            if (task.parent == 0 && task.type !== "milestone") {
                return `Project : ${task.text}`;
            } else if (task.type === "milestone") {
                return task.text;
            } else {
                return `Task : ${task.text}`;
            }
        };

        javascriptGantt.templates.grid_folder = (task) => {
            var name = task?.text?.trim().split(" ");
            var firstname = name?.[0];
            var lastname = name?.[1] ? name?.[1] : "";
            var intials =
                firstname?.charAt(0)?.toUpperCase() +
                lastname?.charAt(0)?.toUpperCase();
            return `<div></div>`;
        };

        javascriptGantt.templates.grid_file = (task) => {
            if (task.parent != 0) {
                var tracker_name = task.hasOwnProperty("tracker")
                    ? task.tracker.name
                    : " ";
                let issue_id = task.id;
                return `<div class='gantt_file ${tracker_name}'><a  class="link-issue ${tracker_name}" href='http://127.0.0.1:5500//issues/${issue_id}'>#${issue_id}</a></div>`;
            }
        };

        javascriptGantt.templates.task_drag = (mode, task) => {
            if (task.parent == 0 || (task.children && task.children.length > 0)) {
                // || task.children
                return false;
            }
            return true;
        };

        // add custom classes
        // javascriptgantt.templates.grid_header_class = (columns,i) => {
        //   return "my-header-class test"
        // }
        // javascriptgantt.templates.grid_row_class = (start, end, task) => {
        //   console.log(start, end);
        //   return "my-grid-row-class test"
        // }
        javascriptGantt.templates.task_class = (start, end, task) => {
            if (task.parent == 0) {
                return "parent-task test";
            } else {
                return "child-task test";
            }
        };
        // javascriptgantt.templates.task_row_class = (start, end, task) => {
        //   return "my-task-row-class test"
        // }
        javascriptGantt.templates.scale_cell_class = (date, scale, scaleIndex) => {
            if (scaleIndex === 1) {
                return "my-scale-class-2";
            } else {
                return "my-scale-class-1";
            }
        };
        // javascriptgantt.templates.grid_cell_class = (col, task) => {
        //   return "my-grid-cell-class test"
        // }
        // javascriptgantt.templates.timeline_cell_class = (task, date) => {
        //   return "my-task-cell-class  Test  "
        // }

        // add custom marker
        javascriptGantt.addMarker({
            start_date: javascriptGantt.add(new Date(), 1, "day"), //a Date object that sets the marker's date
            css: "tomorrow", //a CSS class applied to the marker
            text: "Tomorrow", //the marker title
            title: javascriptGantt.formatDateToString(
                "%d %F %y",
                javascriptGantt.add(new Date(), 1, "day")
            ), // the marker's tooltip
        });

        // javascriptgantt.addMarker({
        //   start_date: javascriptgantt.add(new Date(),-1, "day"), //a Date object that sets the marker's date
        //   css: "yesterday", //a CSS class applied to the marker
        //   text: "Yesterday", //the marker title
        //   title: javascriptgantt.formatDateToString("%d %F %Y", javascriptgantt.add(new Date(),-1, "day")), // the marker's tooltip
        // });

        // render gantt
        javascriptGantt.render(element);

        const jsGanttTheme = localStorage.getItem('javascriptgantt-theme');


        // console.log(javascriptgantt);

        // to find task in gantt
        // console.log(javascriptgantt.getTask(69));

        // custom events
        javascriptGantt.attachEvent("onTaskDblClick", (event) => {
            // console.log("onTaskDblClick: ", event);
        });
        let idCount = 0;
        javascriptGantt.attachEvent("selectAreaOnDrag", (event) => {
            // console.log("selectAreaOnDrag: ", event.task);
            javascriptGantt.addTask({
                id: "Added" + idCount,
                start_date: new Date(event.task.startDate),
                end_date: new Date(event.task.endDate),
                parent: event.task.parent,
                text: "Task Added",
            });
            javascriptGantt.render();
            idCount += 1;
        });
        javascriptGantt.attachEvent("onLinkDblClick", (event) => {
            // console.log("onLinkDblClick: ", event);
            // javascriptgantt.deleteLink(event.link.id);
        });
        javascriptGantt.attachEvent("onBeforeLinkAdd", (event) => {
            // console.log("onBeforeLinkAdd: ", event);
        });
        javascriptGantt.attachEvent("onLinkAdd", (event) => {
            // console.log("onLinkAdd: ", event);
        });
        javascriptGantt.attachEvent("onDeleteLink", (event) => {
            // console.log("onDeleteLink: ", event);
        });
        javascriptGantt.attachEvent("onBeforeTaskDrag", (event) => {
            // console.log("onBeforeTaskDrag: ", event);
            if (event.task.children.length !== 0) {
                return false;
            } else {
                return true;
            }
        });
        javascriptGantt.attachEvent("onTaskDrag", (event) => {
            // console.log("onTaskDrag: ", event);
        });
        javascriptGantt.attachEvent("onAfterTaskDrag", (event) => {
            console.log("onAfterTaskDrag: ", event);
            console.log("onAfterTaskDrag??: ", javascriptGantt.options.data);
            // javascriptgantt.autoScheduling(); 
        });
        javascriptGantt.attachEvent("onBeforeTaskDrop", (event) => {
            console.log("onBeforeTaskDrop: ", event);
            if (event.parentTask?.id == 12) {
                return false;
            }
        });
        javascriptGantt.attachEvent("onTaskToggle", (event) => {
            // console.log("onTaskToggle: ", event);
        });

        javascriptGantt.attachEvent("onTaskDelete", (event) => {
            console.log("onTaskDelete: ", event);
        });
        javascriptGantt.attachEvent("onAfterTaskUpdate", (event) => {
            // console.log("onAfterTaskUpdate: ", event);
        });
        javascriptGantt.attachEvent("onCellClick", (event) => {
            // console.log("onCellClick: ", event);
        });
        javascriptGantt.attachEvent("onRequestFullScreen", (event) => {
            // console.log("onRequestFullScreen: ", event);
        });
        javascriptGantt.attachEvent("onExitFullScreen", (event) => {
            // console.log("onExitFullScreen: ", event);
        });
        // javascriptgantt.attachEvent("onScroll", (event) => {
        //   console.log("onScroll: ", event);
        // });
        // javascriptgantt.attachEvent("onResize", (event) => {
        //   console.log("onResize: ", event);
        // });
        javascriptGantt.attachEvent("onAfterProgressDrag", (event) => {
            // console.log("onAfterProgressDrag: ", event);
        });
        javascriptGantt.attachEvent("onBeforeProgressDrag", (event) => {
            // console.log("onBeforeProgressDrag: ", event);
            // if(event.task.parent === 0){
            //   return false;
            // }else{
            //   return true;
            // }
        });
        javascriptGantt.attachEvent("onAutoScheduling", (event) => {
            // console.log("onAutoScheduling: ", event);
        });
        javascriptGantt.attachEvent("onColorChange", (event) => {
            // console.log("onColorChange: ", event);
        });
        javascriptGantt.attachEvent("onBeforeTaskDblClick", (event) => {
            // console.log("onBeforeTaskDblClick: ", event);
            // if(event.task.id === 3){
            //   return false;
            // }
        });
        javascriptGantt.attachEvent("onBeforeSave", (event) => {
            // console.log("onBeforeSave: ", event);
        });
        javascriptGantt.attachEvent("onSave", (event) => {
            // console.log("onSave: ", event);
        });

        let fullscreen = false;
        function changeScreen() {
            if (fullscreen === false) {
                javascriptGantt.requestFullScreen();
                // javascriptgantt.openTask(3);
            } else {
                javascriptGantt.exitFullScreen();
            }
        }

        function changeZoom(e) {
            javascriptGantt.options.zoomLevel = e.target.value;
            if (e.target.value === "month" || e.target.value === "quarter") {
                javascriptGantt.options.startDate = "2024-01-01T11:46:17.775Z";
                javascriptGantt.options.endDate = "2024-12-31T11:46:17.775Z";
            } else if (e.target.value === "year") {
                javascriptGantt.options.startDate = "2022-01-01T11:46:17.775Z";
                javascriptGantt.options.endDate = "2024-12-31T11:46:17.775Z";
            } else {
                javascriptGantt.options.startDate = "2024-03-01T11:46:17.775Z";
                javascriptGantt.options.endDate = "2024-03-30T11:46:17.775Z";
            }
            javascriptGantt.zoomInit();
        }

        function changeLang(e) {
            javascriptGantt.setLocalLang(e.target.value);
        }

        function changeCollapse(e) {
            if (e.target.checked === true) {
                javascriptGantt.collapseAll();
            } else {
                javascriptGantt.expandAll();
            }
        }

        function changeToday(e) {
            if (event.target.checked === true) {
                javascriptGantt.addTodayFlag();
            } else {
                javascriptGantt.removeTodayFlag();
            }
        }

        function exportChange(e) {
            let stylesheet = [];
            if (e.target.value === "png") {
                javascriptGantt.exportToPNG("jsGanttChart", stylesheet);
            } else if (e.target.value === "pdf") {
                javascriptGantt.exportToPDF("jsGanttChart", stylesheet);
            } else {
                javascriptGantt.exportToExcel("jsGanttChart");
            }
            e.target.value = "";
        }

        function autoScheduling() {
            javascriptGantt.autoScheduling();
        }
        function addTask() {
            javascriptGantt.addTask({
                id: 5354653546,
                tracker_id: 4,
                project_id: 86,
                subject:
                    "Workflow - In the Workflow view, JOC reacts slow when handling large workflows or multiple smaller workflows in the same folder.",
                description:
                    "requirements-\r\nwhen in the WORKFLOWÂ view a larger workflow (several hundred jobs) or multiple smaller workflows in the same folder are completely expanded then JOC reacts rather slowly.\r\nThis affects actions like scrolling, opening instruction and order menus and executing items of these menus.",
                due_date: "2024-05-17",
                category_id: null,
                status_id: 2,
                assigned_to_id: 308,
                priority_id: 2,
                fixed_version_id: null,
                author_id: 308,
                lock_version: 3,
                created_on: "2024-05-18T05:03:17.000Z",
                updated_on: "2024-05-18T05:03:25.000Z",
                start_date: "2024-05-17",
                done_ratio: 70,
                estimated_hours: 8.5,
                parent: 12,
                parent_id: null,
                root_id: 53546,
                lft: 1,
                rgt: 2,
                is_private: false,
                closed_on: null,
                tag_list: [],
            });
            // setTimeout(()=>{

            //   javascriptgantt.openTask(280);
            // },0)
            // javascriptgantt.parse(data);
            javascriptGantt.render();
            // javascriptgantt.deleteLink(1);
        }

        // get the position of the cell
        // console.log(javascriptgantt.posFromDate(new Date()));

        // iterate over each task
        // javascriptgantt.eachTask((task)=>{
        //   console.log(task._id,"task _id ?????????????????????????????????");
        // })

        let cssStyle;

        function changeTheme(isDark) {
            const root = document.querySelector(":root");
            if (isDark) {
                document.getElementById('toggle').checked = true;
                cssStyle = document.createElement("link");
                cssStyle.setAttribute("rel", "stylesheet");
                cssStyle.setAttribute("href", "src/theme/dark.css");
                document.getElementsByTagName("head")[0].append(cssStyle);
                localStorage.setItem('javascriptgantt-theme', 'dark');

                root.style.setProperty("--bg-color", "#333332");
                root.style.setProperty("--text-color", "#fff");
                root.style.setProperty("--text-secondary-color", "#fff");
                root.style.setProperty("--index-primary-color", "#1395BE");
                root.style.setProperty("--index-primary-hover-color", "#0E7595");
            } else {
                if (cssStyle) {
                    cssStyle.remove();
                }
                root.style.setProperty("--bg-color", "#fff");
                root.style.setProperty("--text-color", "#000");
                root.style.setProperty("--text-secondary-color", "#fff");
                root.style.setProperty("--index-primary-color", "#4ca0fff2");
                root.style.setProperty("--index-primary-hover-color", "#3585e0f2");
                localStorage.setItem('javascriptgantt-theme', 'light');
            }
        }

        this.changeTheme(jsGanttTheme == 'dark');

        let getScale = () => {
            console.log(javascriptGantt.getScale());
        };

        function searchTask(e) {
            let isFilter = e.target.value.trim() !== "";
            javascriptGantt.filterTask((task) => {
                return task.text.toLowerCase().includes(e.target.value.toLowerCase());
            }, isFilter, true);
        }
        function addCol() {
            javascriptGantt.options.columns.push({
                name: "progress",
                width: 245,
                min_width: 80,
                max_width: 300,
                tree: false,
                label: "Progress",
                resize: true,
                align: "center",
                template: (task) => {
                    return `<span>${task.progress || 0}</span>`;
                },
            });
            javascriptGantt.render();
        }

        function removeCol() {
            javascriptGantt.options.columns.splice(javascriptGantt.options.columns.length - 1, 1);
            javascriptGantt.render();
        }

        function startTour() {
            let options = {
                overlayOpacity: 0.7,
                stagePadding: 10,
                stageRadius: 5,
                overlayColor: "#000",
                animate: true,
                smoothScroll: true,
                allowBackdropClose: true,
                popupClass: "popupClass",
                keyboardControl: true,
                showProgress: true,
                visibleButtons: ['next', 'previous', 'close'],
                disableButtons: [],
                animationDuration: 400,
                onNextClick: (step) => {
                    console.log(step, " Next Click");
                },
                onClose: () => {
                    console.log("Tour Closed");
                },
                onPreviousClick: (step) => {
                    console.log(step, " Previous Click");
                },
                steps: [
                    {
                        element: ".collapse-container",
                        popup: {
                            title: "Toggle Collapse",
                            description: "Toggle all the Tasks!!",
                            side: "bottom",
                            align: "start",
                        },
                    },
                    {
                        element: ".today-container",
                        popup: {
                            title: "Toggle Marker",
                            description: "Toggle Today Marker!!",
                            side: "bottom",
                            align: "start",
                        },
                    },
                    {
                        element: ".export-data",
                        popup: {
                            title: "Export Chart",
                            description: "Get your charts in PDF, PNG, or Excel formats",
                            side: "bottom",
                            align: "center",
                        },
                    },
                    {
                        element: ".fullscreen",
                        popup: {
                            title: "Full Screen",
                            description: "View your Gantt in full screen for an immersive experience",
                            side: "bottom",
                            align: "end",
                        },
                    },
                    {
                        element: ".auto-scheduling",
                        popup: {
                            title: "Auto Scheduling",
                            description: "Tasks are automatically scheduled.",
                            side: "bottom",
                            align: "center",
                        },
                    },
                    {
                        element: ".zoom",
                        popup: {
                            title: "Zoom Levels",
                            description: "Multiple timeline views - hour, day, week, month, quarter, and year.",
                            side: "bottom",
                            align: "end",
                        },
                    },
                    {
                        element: ".Language",
                        popup: {
                            title: "Change Language",
                            description: "Change language of the gantt chart.",
                            side: "bottom",
                            align: "end",
                        },
                    },
                    {
                        element: ".dark-mode",
                        popup: {
                            title: "Toggle Dark Mode",
                            description: "Dark mode for those late-night work sessions.",
                            side: "bottom",
                            align: "end",
                        },
                    },
                    {
                        element: ".gantt-search",
                        popup: {
                            title: "Search Tasks",
                            description: "Search Tasks to quickly find and access tasks based on your search criteria. Streamline your workflow by searching for specific tasks with ease.",
                            side: "bottom",
                            align: "end",
                        },
                    },
                    {
                        element: "#js-gantt",
                        popup: {
                            title: "Gantt Chart",
                            description: "The Gantt Chart view provides a visual representation of project tasks and their timelines, allowing you to efficiently manage project schedules, dependencies, and progress. Easily track and plan tasks, making project management a seamless experience.",
                            side: "top",
                            align: "start",
                        },
                    },
                    {
                        popup: {
                            title: "That's everything",
                            description: `<div class="finish">
                  <p>Looks like you're ready to go ðŸŽ‰</p>
                  <p>Click anywhere to exit the tour.</p>
                  <img src="https://media.tenor.com/y2JXkY1pXkwAAAAM/cat-computer.gif">
                  </div>`,
                            side: "over",
                            align: "over",
                        },
                    },
                ],
            };
            let tour = new ztTour(options);
            // console.log(ztTour,"ztTour");
            tour.start();
        }

        document.querySelector(".hint-icon").removeEventListener("click", handleClick);
        document.querySelector(".hint-icon").addEventListener("click", handleClick);

        // let tour = new ztTour({});
        function handleClick(e) {
            tour.showHint({
                element: ".hint-icon",
                innerHTML: `<p>Click on "Start Tour" to start the tour.</p>`
            });
        }
        let intro = `
        <h2 style="font-size: 18px; margin-bottom: 5px; font-weight: 600; text-align:center">javascriptgantt Chart</h2>
        <p style="line-height: 18px; text-align: justify;margin-bottom: 5px;">Welcome to the javascriptgantt Chart Library. 
          This library provides a powerful set of tools and functionalities to create interactive Gantt charts for project management. This documentation will guide you through the installation process, 
          usage instructions, and available features of the library.</p>
          <p>Click on "Start Tour" to start the tour.</p>
          `;
        // tour.showAnnouncement(intro);
    </script>

</body>

</html>